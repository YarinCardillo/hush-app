# docker-compose.prod.yml â€” gethush.live hosted deployment
# Usage: docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d
#
# Differences from docker-compose.yml:
#   - Removes livekit and redis services (using LiveKit Cloud instead)
#   - Caddy uses Caddyfile.prod (HTTPS + HSTS). Set CORS_ORIGIN in .env (e.g. https://gethush.live).
#   - LIVEKIT_* vars from environment (set in hosting platform, not docker-compose)

version: "3.8"

services:
  # Production Caddy: HTTPS site block + HSTS. Set CORS_ORIGIN in .env.
  caddy:
    volumes:
      - ./caddy/Caddyfile.prod:/etc/caddy/Caddyfile:ro
      - caddy_data:/data
      - caddy_config:/config

  # Disable self-hosted LiveKit (using LiveKit Cloud)
  livekit:
    profiles:
      - self-hosted-only  # This effectively disables it in prod compose

  # Disable Redis (only needed for self-hosted LiveKit)
  redis:
    profiles:
      - self-hosted-only
